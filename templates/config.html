<!DOCTYPE html>
<!-- Icons from Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuration | Gomas</title>
    <link rel="stylesheet" href="/dist/output.css" />
  </head>
  <body>
    <div class="app-gutters flex flex-col gap-4">
      <h1 class="inline-block text-3xl">
        <span
          class="font-bold text-transparent bg-clip-text bg-gradient-to-r from-rose-600 to-rose-300"
        >
          Gomas
        </span>
        Configuration
      </h1>

      <p class="text-slate-400">Version: {{.Version}}</p>

      <p>
        Using file
        <span class="font-mono px-1 py-0.5 bg-slate-800 rounded-sm"
          >{{.ConfigPath}}</span
        >
      </p>

      <div class="mb-4">
        <textarea
          id="config-editor"
          class="w-full h-96 bg-slate-700 px-3 py-2 rounded font-mono outline-none"
          spellcheck="false"
        >{{.ConfigToml}}</textarea>
      </div>

      <div class="flex gap-4">
        <button
          id="save-button"
          class="btn border-emerald-300 text-emerald-300 hover:bg-emerald-950"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="1em"
            viewBox="0 0 448 512"
          >
            <path
              d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"
            />
          </svg>
          Save
        </button>
        <a href="/" class="btn">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="1em"
            viewBox="0 0 384 512"
          >
            <path
              d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"
            />
          </svg>
          Cancel
        </a>
      </div>
    </div>

    <script type="text/javascript">
      document.getElementById("save-button").addEventListener("click", (e) => {
        const newValue = document.getElementById("config-editor").value;

        console.log(newValue);

        fetch("/api/config", {
          method: "PUT",
          body: newValue,
        })
          .catch((e) => alert(e))
          .then((r) => {
            if (r.ok) {
              alert("Done");
            } else {
              alert("FAILED TO SAVE!");
            }
          });
      });
    </script>
  </body>
</html>
